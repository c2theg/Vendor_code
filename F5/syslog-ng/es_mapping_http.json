# ElasticSearch Mapping for: F5 ASM / HTTP - version 0.1.1 - 3/26/18
# https://support.f5.com/kb/en-us/products/big-ip_ltm/manuals/product/bigip-external-monitoring-implementations-13-0-0/15.html#guid-87e43db0-6700-48d1-8e1b-d52e8bb6c899
{  
   "index_patterns":"http.logs*",
   "settings":{  
      "number_of_shards":3,
      "number_of_replicas" : 0,
      "refresh_interval": "10s",      
      "index.routing.allocation.include.size": "small",
      "index.routing.allocation.include.rack": "r1"
   },
   "mappings":{ 
         "properties":{  
            "@timestamp":{  
               "type":"date",
               "format":"strict_date_optional_time||epoch_millis"
            },
            "@version":{  
               "type":"text"
            },
            "agent":{  
               "type":"text",
               "analyzer":"english",
               "fields":{  
                  "raw":{  
                     "type":"text",
                     "index":"false"
                  }
               }
            },
            "bytes_received":{  
               "type":"integer"
            },
            "client_ip":{  
               "type":"ip"
            },
            "client_port":{  
               "type":"text"
            },
            "host":{  
               "type":"text"
            },
            "http_status":{  
               "type":"text"
            },
            "http_version":{  
               "type":"text"
            },
            "message":{  
               "type":"text"
            },
            "path":{  
               "type":"text"
            },
            "referrer":{  
               "type":"text",
               "analyzer":"english",
               "fields":{  
                  "raw":{  
                     "type":"text",
                     "index":"false"
                  }
               }
            },
            "response_time":{  
               "type":"integer"
            },
            "server_ip":{  
               "type":"ip"
            },
            "server_port":{  
               "type":"text"
            },
            "syslog_hostname":{  
               "type":"text",
               "analyzer":"english",
               "fields":{  
                  "raw":{  
                     "type":"text",
                     "index":"false"
                  }
               }
            },
            "syslog_timestamp":{  
               "type":"text"
            },
            "uri_path":{  
               "type":"text",
               "analyzer":"english",
               "fields":{  
                  "raw":{  
                     "type":"text",
                     "index":"false"
                  }
               }
            },
            "virtual_port":{  
               "type":"text"
            },
            "vitual_ip":{  
               "type":"ip"
            }
         }
      }
}
